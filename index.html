<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Valoración</title>
    <style>
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .highlight {
            background-color: red;
        }
    </style>
</head>
<body>
    <form id="valoracionForm">
        <div id="section1" class="section active">
            <h2>Valoración Inicial</h2>
            <fieldset>
                <legend>Datos Administrativos</legend>
                <div>
                    <label for="nhc">NHC:</label>
                    <input type="text" id="nhc" name="nhc">
                </div>
                <div>
                    <label for="primerApellido">1er Apellido:</label>
                    <input type="text" id="primerApellido" name="primerApellido">
                </div>
                <div>
                    <label for="segundoApellido">2º Apellido:</label>
                    <input type="text" id="segundoApellido" name="segundoApellido">
                </div>
                <div>
                    <label for="nombre">Nombre:</label>
                    <input type="text" id="nombre" name="nombre">
                </div>
                <div>
                    <label for="edad">Edad:</label>
                    <input type="number" id="edad" name="edad">
                </div>
                <div>
                    <label for="sexo">Sexo:</label>
                    <select id="sexo" name="sexo">
                        <option value="1">Hombre</option>
                        <option value="2">Mujer</option>
                    </select>
                </div>
                <div>
                    <label for="peso">Peso:</label>
                    <input type="number" id="peso" name="peso">
                </div>
                <div>
                    <label for="talla">Talla:</label>
                    <input type="number" id="talla" name="talla">
                </div>
            </fieldset>
            <fieldset>
                <legend>Trasplante</legend>
                <div>
                    <label for="tipoTrasplante">Tipo de Trasplante:</label>
                    <select id="tipoTrasplante" name="tipoTrasplante">
                        <option value="1">Trasplante</option>
                        <option value="2">Re-trasplante</option>
                    </select>
                </div>
                <div>
                    <label>Indicación:</label>
                    <div>
                        <input type="checkbox" id="hepatocarcinoma" name="indicacion" value="Hepatocarcinoma">
                        <label for="hepatocarcinoma">Hepatocarcinoma</label>
                    </div>
                    <div>
                        <input type="checkbox" id="cirrosisAlcoholica" name="indicacion" value="Cirrosis Alcohólica">
                        <label for="cirrosisAlcoholica">Cirrosis Alcohólica</label>
                    </div>
                    <div>
                        <input type="checkbox" id="cirrosisVirusB" name="indicacion" value="Cirrosis por virus B">
                        <label for="cirrosisVirusB">Cirrosis por virus B</label>
                    </div>
                    <div>
                        <input type="checkbox" id="cirrosisVirusC" name="indicacion" value="Cirrosis por virus C">
                        <label for="cirrosisVirusC">Cirrosis por virus C</label>
                    </div>
                    <div>
                        <input type="checkbox" id="cirrosisNASH" name="indicacion" value="Cirrosis NASH">
                        <label for="cirrosisNASH">Cirrosis NASH</label>
                    </div>
                    <div>
                        <input type="checkbox" id="cirrosisAutoinmune" name="indicacion" value="Cirrosis Autoinmune">
                        <label for="cirrosisAutoinmune">Cirrosis Autoinmune</label>
                    </div>
                    <div>
                        <input type="checkbox" id="cirrosisCriptogenica" name="indicacion" value="Cirrosis Criptogénica">
                        <label for="cirrosisCriptogenica">Cirrosis Criptogénica</label>
                    </div>
                    <div>
                        <input type="checkbox" id="cirrosisBiliarPrimaria" name="indicacion" value="Cirrosis Biliar Primaria">
                        <label for="cirrosisBiliarPrimaria">Cirrosis Biliar Primaria</label>
                    </div>
                    <div>
                        <input type="checkbox" id="colangitisEsclerosante" name="indicacion" value="Colangitis Esclerosante">
                        <label for="colangitisEsclerosante">Colangitis Esclerosante</label>
                    </div>
                    <div>
                        <input type="checkbox" id="hemangioma" name="indicacion" value="Hemangioma">
                        <label for="hemangioma">Hemangioma</label>
                    </div>
                    <div>
                        <input type="checkbox" id="poliquistosisOvarica" name="indicacion" value="Poliquistosis Ovárica">
                        <label for="poliquistosisOvarica">Poliquistosis Ovárica</label>
                    </div>
                    <div>
                        <input type="checkbox" id="buddChiari" name="indicacion" value="Budd Chiari">
                        <label for="buddChiari">Budd Chiari</label>
                    </div>
                    <div>
                        <input type="checkbox" id="falloHepaticoAgudo" name="indicacion" value="Fallo Hepático Agudo">
                        <label for="falloHepaticoAgudo">Fallo Hepático Agudo</label>
                    </div>
                    <div>
                        <input type="checkbox" id="falloHepaticoAgudoSobreCronico" name="indicacion" value="Fallo Hepático Agudo Sobre Crónico">
                        <label for="falloHepaticoAgudoSobreCronico">Fallo Hepático Agudo Sobre Crónico</label>
                    </div>
                    <div>
                        <input type="checkbox" id="hepatitisAgudaSubfulminante" name="indicacion" value="Hepatítis Aguda subfulminante">
                        <label for="hepatitisAgudaSubfulminante">Hepatítis Aguda subfulminante</label>
                    </div>
                    <div>
                        <input type="checkbox" id="trombosisArteriaHepatica" name="indicacion" value="Trombosis de arteria Hepática">
                        <label for="trombosisArteriaHepatica">Trombosis de arteria Hepática</label>
                    </div>
                    <div>
                        <input type="checkbox" id="trombosisPortal" name="indicacion" value="Trombosis Portal">
                        <label for="trombosisPortal">Trombosis Portal</label>
                    </div>
                    <div>
                        <input type="checkbox" id="malfuncionPrimaria" name="indicacion" value="Malfunción Primaria">
                        <label for="malfuncionPrimaria">Malfunción Primaria</label>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend>Clasificación Child Pugh</legend>
                <div>
                    <label for="ascitis">Ascitis:</label>
                    <select id="ascitis" name="ascitis" onchange="updateChildPughScore()">
                        <option value="1" selected>Ausente</option>
                        <option value="2">Leve</option>
                        <option value="3">Moderada</option>
                    </select>
                </div>
                <div>
                    <label for="bilirrubina">Bilirrubina:</label>
                    <select id="bilirrubina" name="bilirrubina" onchange="updateChildPughScore()">
                        <option value="1" selected>&lt;=2</option>
                        <option value="2">2-3</option>
                        <option value="3">&gt;3</option>
                    </select>
                </div>
                <div>
                    <label for="inr">INR:</label>
                    <select id="inr" name="inr" onchange="updateChildPughScore()">
                        <option value="1" selected>&lt;1.8</option>
                        <option value="2">1.8-2.3</option>
                        <option value="3">&gt;2.3</option>
                    </select>
                </div>
                <div>
                    <label for="encefalopatia">Encefalopatía:</label>
                    <select id="encefalopatia" name="encefalopatia" onchange="updateChildPughScore()">
                        <option value="1" selected>Ausente</option>
                        <option value="2">Grado 1-2</option>
                        <option value="3">Grado 3-4</option>
                    </select>
                </div>
                <div>
                    <label for="childPughScore">Puntuación Child Pugh:</label>
                    <span id="childPughScore">4</span>
                </div>
                <div>
                    <label for="escalaChild">Escala Child:</label>
                    <select id="escalaChild" name="escalaChild" onchange="highlightChildRow()">
                        <option value="1">Child A: 5-6 puntos</option>
                        <option value="2">Child B: 7-9 puntos</option>
                        <option value="3">Child C: 10-15 puntos</option>
                    </select>
                </div>
                <h3>Escala West Haven de la Encefalopatía Hepática</h3>
                <table border="1">
                    <tr>
                        <th>Grado</th>
                        <th>Descripción</th>
                    </tr>
                    <tr>
                        <td>0</td>
                        <td>Sin alteraciones</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Alteración mínima del comportamiento</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Desorientación leve, asterixis</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Confusión severa, somnolencia</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Coma</td>
                    </tr>
                </table>
                <h3>Mortalidad de los pacientes a un año y dos años en función de la clasificación Child</h3>
                <table border="1" id="mortalidadChildTable">
                    <tr>
                        <th>Clasificación Child</th>
                        <th>Mortalidad a 1 año</th>
                        <th>Mortalidad a 2 años</th>
                    </tr>
                    <tr id="childA">
                        <td>Child A</td>
                        <td>100%</td>
                        <td>85%</td>
                    </tr>
                    <tr id="childB">
                        <td>Child B</td>
                        <td>80%</td>
                        <td>60%</td>
                    </tr>
                    <tr id="childC">
                        <td>Child C</td>
                        <td>45%</td>
                        <td>35%</td>
                    </tr>
                </table>
            </fieldset>
            <fieldset>
                <legend>Puntuación MELD</legend>
                <div>
                    <label for="creatinina">Creatinina (mg/dl):</label>
                    <input type="number" id="creatinina" name="creatinina" step="0.01" value="1" onchange="updateMeldScores()">
                </div>
                <div>
                    <label for="inrMeld">INR:</label>
                    <input type="number" id="inrMeld" name="inrMeld" step="0.01" value="1" onchange="updateMeldScores()">
                </div>
                <div>
                    <label for="bilirrubinaMeld">Bilirrubina (mg/dl):</label>
                    <input type="number" id="bilirrubinaMeld" name="bilirrubinaMeld" step="0.01" value="1" onchange="updateMeldScores()">
                </div>
                <div>
                    <label for="sodio">Na (mmol/L):</label>
                    <input type="number" id="sodio" name="sodio" step="0.01" value="140" onchange="updateMeldScores()">
                </div>
                <div>
                    <label>Creatinina: Valor máximo 4. Si el paciente ha sido sometido a diálisis 2 veces en la semana previa, puntuar 4</label>
                </div>
                <div>
                    <label for="meldScore">MELD Score:</label>
                    <span id="meldScore">0</span>
                </div>
                <div>
                    <label for="meldNaScore">MELD-Na Score:</label>
                    <span id="meldNaScore">0</span>
                </div>
                <h3>Mortalidad a tres meses</h3>
                <table border="1" id="mortalidadTresMesesTable">
                    <tr>
                        <th>Valores MELD</th>
                        <th>Mortalidad</th>
                    </tr>
                    <tr id="meld40">
                        <td>40 o más</td>
                        <td>71%</td>
                    </tr>
                    <tr id="meld30_39">
                        <td>30-39</td>
                        <td>52%</td>
                    </tr>
                    <tr id="meld20_29">
                        <td>20-29</td>
                        <td>19%</td>
                    </tr>
                    <tr id="meld10_19">
                        <td>10-19</td>
                        <td>6%</td>
                    </tr>
                    <tr id="meldMenor9">
                        <td>&lt;9</td>
                        <td>2%</td>
                    </tr>
                </table>
            </fieldset>
            <button type="button" onclick="showNextSection(1)">Siguiente</button>
        </div>
        <div id="section2" class="section">
            <h2>Valoración Cardiológica</h2>
            <!-- Contenido de la sección -->
            <button type="button" onclick="showPreviousSection(2)">Anterior</button>
            <button type="button" onclick="showNextSection(2)">Siguiente</button>
        </div>
        <div id="section3" class="section">
            <h2>Valoración Pulmonar y Vía aérea</h2>
            <!-- Contenido de la sección -->
            <button type="button" onclick="showPreviousSection(3)">Anterior</button>
            <button type="button" onclick="showNextSection(3)">Siguiente</button>
        </div>
        <div id="section4" class="section">
            <h2>Valoración Renal</h2>
            <!-- Contenido de la sección -->
            <button type="button" onclick="showPreviousSection(4)">Anterior</button>
            <button type="button" onclick="showNextSection(4)">Siguiente</button>
        </div>
        <div id="section5" class="section">
            <h2>Valoración Hematológica</h2>
            <!-- Contenido de la sección -->
            <button type="button" onclick="showPreviousSection(5)">Anterior</button>
            <button type="button" onclick="showNextSection(5)">Siguiente</button>
        </div>
        <div id="section6" class="section">
            <h2>Valoración Endocrinometabólica</h2>
            <!-- Contenido de la sección -->
            <button type="button" onclick="showPreviousSection(6)">Anterior</button>
            <button type="button" onclick="showNextSection(6)">Siguiente</button>
        </div>
        <div id="section7" class="section">
            <h2>Estimación de riesgos y recomendaciones</h2>
            <!-- Contenido de la sección -->
            <button type="button" onclick="showPreviousSection(7)">Anterior</button>
        </div>
    </form>

    <script>
        function showNextSection(currentSection) {
            document.getElementById('section' + currentSection).classList.remove('active');
            document.getElementById('section' + (currentSection + 1)).classList.add('active');
        }

        function showPreviousSection(currentSection) {
            document.getElementById('section' + currentSection).classList.remove('active');
            document.getElementById('section' + (currentSection - 1)).classList.add('active');
        }

        function updateChildPughScore() {
            const ascitis = parseInt(document.getElementById('ascitis').value);
            const bilirrubina = parseInt(document.getElementById('bilirrubina').value);
            const inr = parseInt(document.getElementById('inr').value);
            const encefalopatia = parseInt(document.getElementById('encefalopatia').value);

            const totalScore = ascitis + bilirrubina + inr + encefalopatia;
            document.getElementById('childPughScore').innerText = totalScore;

            const escalaChild = document.getElementById('escalaChild');
            if (totalScore >= 5 && totalScore <= 6) {
                escalaChild.value = "1";
            } else if (totalScore >= 7 && totalScore <= 9) {
                escalaChild.value = "2";
            } else if (totalScore >= 10 && totalScore <= 15) {
                escalaChild.value = "3";
            }
            highlightChildRow();
        }

        function highlightChildRow() {
            const escalaChild = document.getElementById('escalaChild').value;
            document.getElementById('childA').classList.remove('highlight');
            document.getElementById('childB').classList.remove('highlight');
            document.getElementById('childC').classList.remove('highlight');

            if (escalaChild === "1") {
                document.getElementById('childA').classList.add('highlight');
            } else if (escalaChild === "2") {
                document.getElementById('childB').classList.add('highlight');
            } else if (escalaChild === "3") {
                document.getElementById('childC').classList.add('highlight');
            }
        }

        function updateMeldScores() {
            let creatinina = parseFloat(document.getElementById('creatinina').value) || 0;
            if (creatinina > 4) {
                creatinina = 4;
            }
            const bilirrubina = parseFloat(document.getElementById('bilirrubinaMeld').value) || 0;
            const inr = parseFloat(document.getElementById('inrMeld').value) || 0;
            const sodio = parseFloat(document.getElementById('sodio').value) || 0;

            const meldScore = 9.6 * Math.log(creatinina) + 3.8 * Math.log(bilirrubina) + 11.2 * Math.log(inr) + 6.4;
            const meldNaScore = meldScore - sodio - (0.025 * meldScore * (140 - sodio)) + 140;

            document.getElementById('meldScore').innerText = meldScore.toFixed(2);
            document.getElementById('meldNaScore').innerText = meldNaScore.toFixed(2);

            highlightMeldRow(meldScore);
        }

        function highlightMeldRow(meldScore) {
            document.getElementById('meld40').classList.remove('highlight');
            document.getElementById('meld30_39').classList.remove('highlight');
            document.getElementById('meld20_29').classList.remove('highlight');
            document.getElementById('meld10_19').classList.remove('highlight');
            document.getElementById('meldMenor9').classList.remove('highlight');

            if (meldScore >= 40) {
                document.getElementById('meld40').classList.add('highlight');
            } else if (meldScore >= 30) {
                document.getElementById('meld30_39').classList.add('highlight');
            } else if (meldScore >= 20) {
                document.getElementById('meld20_29').classList.add('highlight');
            } else if (meldScore >= 10) {
                document.getElementById('meld10_19').classList.add('highlight');
            } else {
                document.getElementById('meldMenor9').classList.add('highlight');
            }
        }
    </script>
</body>
</html>